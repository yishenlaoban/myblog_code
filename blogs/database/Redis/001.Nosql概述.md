---
title: 一、Nosql概述
date: 2022-02-13
categories:
 - 数据库
tags:
 - Nosql
 - Redis
sidebar: 'auto'
---
## 一、Nosql概述

### 为什么使用Nosql

> 1、单机mysql时代

![image-20220207215601489](http://yishenlaoban-img.test.upcdn.net/image_my/image-20220207215601489.png) 

90年代,一个网站的访问量一般不会太大，单个数据库完全够用。随着用户增多，网站出现以下问题

1. 数据量增加到一定程度，单机数据库就放不下了

2. 数据的索引（B+ Tree）,一个机器内存也存放不下

3. 访问量变大后（读写混合），一台服务器承受不住。

   

> 2、MemCached (缓存)+ Mysql +垂直差分 

网站80%的情况都是在读，每次都要去查询数据库的话就十分的麻烦！所以说我们希望减轻数据库的压力，我们可以使用缓存来保证效率！

![image-20220207220837661](http://yishenlaoban-img.test.upcdn.net/image_my/image-20220207220837661.png) 

优化过程经历了以下几个过程：

        * 优化数据库的数据结构和索引(难度大)
        * 文件缓存，通过IO流获取比每次都访问数据库效率略高，但是流量爆炸式增长时候，IO流也承受不了
        * MemCache,当时最热门的技术，通过在数据库和数据库访问层之间加上一层缓存，第一次访问时查询数据库，将结果保存到缓存，后续的查询先检查缓存，若有直接拿去使用，效率显著提升。



> 3、分库分表 + 水平拆分 + Mysql集群

==本质：数据库的读写问题==

早些年的引擎MyISAM：表锁，十分影响效率！高并发下就会出现严重的锁问题

转战Innodb: 行锁

慢慢的就开始使用分表来解决写的压力！MySql在那个 年代推出了表分区，这个并没有多少公司使用

Mysql集群的出现，很好的满足了那个年代所有需求

![image-20220207224716594](http://yishenlaoban-img.test.upcdn.net/image_my/image-20220207224716594.png) 

 

> 4、如今最近的年代

2010 --2020 十年之间，互联网世界发生巨大变化（定位也是一种数据，音乐，热榜）

Mysql等关系型数据库就不够用了！数据很多，**变化很快~**

Mysql有的使用它来存储一些比较大的文件，博客，图片！数据很大，效率就低了！如果有一种数据库来专门处理这种数据，

Mysql的压力就会变的十分小（研究如何处理这些问题！）大数据的IO压力下，表结构几乎没法更改！

> 为什么要用NoSQL ？

用户的个人信息，社交网络，地理位置。用户自己产生的数据，用户日志等等爆发式增长！
这时候我们就需要使用NoSQL数据库的，Nosql可以很好的处理以上的情况！



### 什么是Nosql

==NoSQL = Not Only SQL（不仅仅是SQL==

Not Only Structured Query Language

关系型数据库：列+行，同一个表下数据的结构是一样的。

非关系型数据库：==数据存储没有固定的格式，并且可以进行横向扩展。==

NoSQL泛指非关系型数据库，随着web2.0互联网的诞生，传统的关系型数据库很难对付web2.0时代！尤其是超大规模的高并发的社区，暴露出来很多难以克服的问题，NoSQL在当今大数据环境下发展的十分迅速，Redis是发展最快的。


### Nosql特点

   1.方便扩展（数据之间没有关系，很好扩展）

   2.大数据量高性能（Redis一秒可以写8万次，读11万次，NoSQL的缓存记录级的，是一种细粒度的缓存，性能会比较高！）

   3.数据类型是多样型的！ （不需要事先就设计好数据库，随取随用）

   4.传统的RDBMS 和NoSQL

```xml
传统的 RDBMS(关系型数据库)
- 结构化组织
- SQL
- 数据和关系都存在单独的表中 row col
- 操作，数据定义语言
- 严格的一致性
- 基础的事务
- ...
```

```xml
Nosql
- 不仅仅是数据
- 没有固定的查询语言
- 键值对存储，列存储，文档存储，图形数据库（社交关系）
- 最终一致性
- CAP定理和BASE
- 高性能，高可用，高扩展
- ...
```

> 了解：3V + 3高

大数据时代的3V ：主要是**描述问题**的

1. 海量Velume
2. 多样Variety
3. 实时Velocity

大数据时代的3高 ： 主要是**对程序的要求**

1. 高并发
2. 高可扩
3. 高性能

真正在公司中的实践：NoSQL + RDBMS 一起使用才是最强的。



### 阿里巴巴演进分析

推荐阅读：阿里云的这群疯子https://yq.aliyun.com/articles/653511

![image-20220209173738641](http://yishenlaoban-img.test.upcdn.net/image_my/image-20220209173738641.png) 

![image-20220209173827436](http://yishenlaoban-img.test.upcdn.net/image_my/image-20220209173827436.png) 



```xml
# 商品信息
- 一般存放在关系型数据库：Mysql,阿里巴巴使用的Mysql都是经过内部改动的。

# 商品描述、评论(文字居多)
- 文档型数据库：MongoDB

# 图片
- 分布式文件系统 FastDFS
- 淘宝：TFS
- Google: GFS
- Hadoop: HDFS
- 阿里云: oss

# 商品关键字 用于搜索
- 搜索引擎：solr,elasticsearch
- 阿里：Isearch 多隆

# 商品热门的波段信息
- 内存数据库：Redis，Memcache

# 商品交易，外部支付接口
- 第三方应用

```

![image-20220209174109354](http://yishenlaoban-img.test.upcdn.net/image_my/image-20220209174109354.png) 



### Nosql的四大分类

> **KV 键值对**

- 新浪：**Redis**
- 美团：Redis + Tair
- 阿里、百度：Redis + Memcache

> **文档型数据库（bson数据格式）：**

- **MongoDB**(掌握)
  - 基于分布式文件存储的数据库。C++编写，用于处理大量文档。
  - MongoDB是RDBMS和NoSQL的中间产品。MongoDB是非关系型数据库中功能最丰富的，NoSQL中最像关系型数据库的数据库。
- ConthDB

> **列存储数据库**

- **HBase**(大数据必学)
- 分布式文件系统

> **图关系数据库**

用于广告推荐，社交网络（社交关系）

- **Neo4j**、InfoGrid

![image-20220209180212522](http://yishenlaoban-img.test.upcdn.net/image_my/image-20220209180212522.png)